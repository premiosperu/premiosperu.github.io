<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CatÃ¡logo Luxe | Google Sheets</title>
<style>
  :root { --radius: 14px; --bg: #fafafa; }
  body { font-family: 'Segoe UI', Arial, sans-serif; margin:0; background: var(--bg); color:#222; }

  header {
    display: grid; grid-template-columns: 1fr 220px; gap: 12px;
    padding: 14px 5%; background: #fff; border-bottom: 1px solid #ddd;
    position: sticky; top: 0; z-index: 100;
  }
  header input, header select {
    padding: 10px 15px; border: 1px solid #ccc; border-radius: 10px; font-size: 14px; outline: none; background: #fdfdfd;
  }

  @media(max-width:720px){ header { grid-template-columns: 1fr 1fr; } }
  @media(max-width:480px){ header { grid-template-columns: 1fr; } }

  .container { max-width: 1200px; margin: 20px auto; padding: 0 16px; }
  .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 18px; }
  
  .card { 
    background: #fff; border: 1px solid #eee; border-radius: var(--radius); 
    padding: 12px; display: flex; flex-direction: column;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .card:hover { transform: translateY(-3px); box-shadow: 0 8px 15px rgba(0,0,0,0.05); }

  .thumb { 
    aspect-ratio: 1/1; background: linear-gradient(135deg, #eee, #ddd); 
    border-radius: 10px; margin-bottom: 10px;
    display: flex; align-items: center; justify-content: center;
  }
  .thumb::after { content: 'ðŸ‘œ'; font-size: 2rem; opacity: 0.2; }

  .title { font-weight: 600; font-size: 14px; margin-bottom: 4px; }
  .meta { font-size: 12px; color: #666; margin-bottom: 2px; }
  .price { font-weight: 700; margin-top: auto; padding-top: 10px; color: #000; }
  
  .hidden { display: none !important; }
  #status { text-align: center; padding: 40px; color: #888; font-size: 14px; }
</style>
</head>
<body>

<header>
  <input id="search" type="text" placeholder="Buscar carteras por nombre o color..." />
  <select id="category">
    <option value="todas">Todas las categorÃ­as</option>
    <option value="mano">Mano</option>
    <option value="hombro">Hombro</option>
    <option value="mochila">Mochila</option>
    <option value="bandolera">Bandolera</option>
    <option value="luxury">Premium</option>
  </select>
</header>

<main class="container">
  <div id="status">Conectando con Google Sheets...</div>
  <div id="products" class="grid"></div>
</main>

<script>
  // 1. TU ENLACE DIRECTO (AsegÃºrate que estÃ© compartido como "Cualquier persona con el enlace puede leer")
  const originalUrl = 'https://docs.google.com/spreadsheets/d/1SbZbDnDjBplG8vKc6Y75ZTn5aqakFLAv7xxM4TQXKP8/edit?gid=0#gid=0';
  
  // 2. TRANSFORMACIÃ“N AUTOMÃTICA A FORMATO DE DATOS (CSV)
  const idMatch = originalUrl.match(/\/d\/(.+?)\//);
  const sheetId = idMatch ? idMatch[1] : '';
  const dataUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/export?format=csv`;

  const grid = document.getElementById('products');
  const status = document.getElementById('status');

  async function init() {
    try {
      const resp = await fetch(dataUrl);
      const csvText = await resp.text();
      
      // Separar por filas y limpiar vacÃ­os
      const rows = csvText.split('\n').map(row => row.split(',')).filter(cols => cols.length >= 4);
      
      // Saltamos la primera fila (cabeceras)
      const productsData = rows.slice(1);

      grid.innerHTML = productsData.map(col => {
        const [nombre, categoria, color, precio] = col.map(c => c.replace(/"/g, '').trim());
        return `
          <div class="card" data-name="${nombre}" data-category="${categoria.toLowerCase()}" data-color="${color}">
            <div class="thumb"></div>
            <div class="title">${nombre}</div>
            <div class="meta">CategorÃ­a: ${categoria}</div>
            <div class="meta">Color: ${color}</div>
            <div class="price">${precio}</div>
          </div>
        `;
      }).join('');

      status.style.display = 'none';
      setupLogic();
    } catch (e) {
      status.innerHTML = "âš ï¸ Error: AsegÃºrate de que el Google Sheet estÃ© compartido pÃºblicamente para lectura.";
    }
  }

  function setupLogic() {
    const search = document.getElementById('search');
    const select = document.getElementById('category');
    const items = [...document.querySelectorAll('.card')];

    function runFilter() {
      const q = search.value.toLowerCase();
      const cat = select.value;
      
      items.forEach(card => {
        const matchesText = card.dataset.name.toLowerCase().includes(q) || card.dataset.color.toLowerCase().includes(q);
        const matchesCat = cat === 'todas' || card.dataset.category.includes(cat);
        card.classList.toggle('hidden', !(matchesText && matchesCat));
      });
    }

    search.addEventListener('input', runFilter);
    select.addEventListener('change', runFilter);
  }

  init();
</script>

</body>
</html>
